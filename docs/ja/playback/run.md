# 再生モード（Playback Mode）

**VoiceScriptPlayer** の再生モードは、**編集モードから分離された純粋な再生専用環境**です。  
このモードでは、タイムラインや編集ツールがすべて無効化され、  
プロジェクトの実際の動作（サウンド、Live2D、Stroke、デバイス連動など）のみが実行されます。

---

## 1. 再生モードの概要

| 項目 | 説明 |
|------|------|
| **目的** | 完成したプロジェクトを実際のように再生したり、デバイス連動テストを行います。 |
| **編集モードとの違い** | 編集機能（選択、移動、設定パネルなど）はすべて無効化され、再生のみ可能です。 |
| **開始方法** | 上部ツールバーの ▶ 再生ボタン、または `vsp://open?file=...` の形式で起動します。 |
| **終了方法** | Esc キーを押すか、ウィンドウを閉じると終了します。 |

> ⚙️ **補足：**  
> 再生モードでは、ユーザーによるキー入力や手動操作は行えません。  
> **すべての進行はスクリプト内で定義されたイベントフローに従って自動的に実行されます。**

---

## 2. プレイモード（Play Mode）

再生モードに入る際、**プレイモード（Play Mode）** オプションで  
デバイスの使用有無や制御方法を設定できます。

| オプション | 説明 |
|-------------|------|
| **指定なし** | デバイスの接続状態に関係なく自由に再生します。 |
| **手動のみ** | デバイス出力を無効化し、画面と音声のみ再生します。 |
| **デバイス推奨** | デバイスが未接続の場合は警告を表示しますが、ユーザーは再生を続行できます。 |
| **デバイス専用** | デバイス接続が必須。接続がない場合は再生がブロックされます。 |

---

### ⚠️ プレイモードの制限と警告

| 状況 | 動作 |
|------|------|
| **デバイス専用モードで未接続の場合** | 「このスクリプトを再生するにはデバイスの接続が必要です。」という警告が表示され、再生は中止されます。 |
| **デバイス推奨モードで未接続の場合** | 「デバイスの接続を推奨します。続行しますか？」という警告が表示され、ユーザーが選択できます。 |
| **デバイス専用モード中に接続が切れた場合** | 再生が一時停止し、「デバイスを再接続して再試行してください。」という警告が表示されます。 |
| **手動のみモード** | デバイス出力は完全に無効化され、Stroke や振動などのハードウェア制御は実行されません。 |

> 💡 **ヒント：**  
> デバイスモードの制約は、プロジェクトスクリプト内に「デバイス依存イベント」が含まれているかどうかによって変わります。  
> 例えば Stroke や TCode の動作を含む場合、「デバイス推奨」または「デバイス専用」に設定するのが安全です。

---

## 3. マイク確認ウィンドウ

実行設定で **「マイク確認ウィンドウを使用」** を有効にすると、  
再生開始前にマイクが認識されているかを確認する専用ウィンドウが表示されます。

| 項目 | 説明 |
|------|------|
| **目的** | 音声認識（STT）や音声反応イベントを含むプロジェクトの正常動作を確認します。 |
| **確認内容** | 接続されているマイク一覧、入力感度、音声テスト機能。 |
| **進行方法** | マイクが正常に認識されると「確認」ボタンが有効化され、再生を続行できます。 |
| **エラー時** | マイクが認識されない場合は警告が表示され、修正するまで実行できません。 |

> 💡 **補足：**  
> マイク認識中にエラーが発生した場合は、  
> [SpeechRecognition 設定ドキュメント](../ai/speechRecognition.md) を参照してください。

---

## 4. 注意事項

- 再生モードでは **編集・保存・リソース変更機能はすべて無効** になります。  
- 「デバイス専用」モードでデバイス未接続の場合、再生はブロックされます。  
- 「マイク確認ウィンドウを使用」が有効な場合、テストを通過しないと再生を開始できません。  
- 再生中にエラーやデバイス接続問題が発生した場合、プログラムは自動的に一時停止し、修復後に再開できます。  

---

## 5. 関連ドキュメント

- [リソース管理タブ](../editor/resources.md)  
- [ランタイムヘルパータブ](../editor/runtime-helper.md)  
- [デバッグ & ログ](debug.md)  
- [SpeechRecognition 設定](../ai/speechRecognition.md)
